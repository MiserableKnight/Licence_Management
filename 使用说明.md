# äººå‘˜è¯ä»¶æœ‰æ•ˆæœŸç®¡æ§ç³»ç»Ÿ - ä½¿ç”¨è¯´æ˜

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

äººå‘˜è¯ä»¶æœ‰æ•ˆæœŸç®¡æ§ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºPythonçš„è‡ªåŠ¨åŒ–è¯ä»¶ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ï¼š
- ğŸ“Š æ‰¹é‡ç®¡ç†äººå‘˜è¯ä»¶ä¿¡æ¯
- ğŸ“§ è‡ªåŠ¨å‘é€åˆ°æœŸæé†’é‚®ä»¶  
- ğŸ“ˆ ç”Ÿæˆè¯ä»¶çŠ¶æ€æŠ¥å‘Š
- âš™ï¸ æ”¯æŒçµæ´»çš„é…ç½®ç®¡ç†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

**ç³»ç»Ÿè¦æ±‚ï¼š**
- Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬
- Windows/macOS/Linux ç³»ç»Ÿ

**å®‰è£…ä¾èµ–ï¼š**
```bash
pip install -r requirements.txt
```

### 2. é…ç½®ç³»ç»Ÿ

**ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œåˆ›å»ºé…ç½®æ–‡ä»¶ï¼š**
```bash
python -m licence_management --init-config
```

**å¤åˆ¶å¹¶ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š**
```bash
# Windows
copy config_templates\config_template.yaml config.yaml

# macOS/Linux  
cp config_templates/config_template.yaml config.yaml
```

**ç¼–è¾‘ `config.yaml` æ–‡ä»¶ï¼Œé…ç½®é‚®ä»¶æœåŠ¡å™¨ä¿¡æ¯ï¼š**
```yaml
email:
  smtp_server: smtp.qq.com          # é‚®ä»¶æœåŠ¡å™¨åœ°å€
  smtp_port: 587                    # ç«¯å£å·
  smtp_user: your_email@qq.com      # å‘ä»¶é‚®ç®±
  smtp_password: your_auth_code     # é‚®ç®±æˆæƒç 
  sender_name: è¯ä»¶ç®¡ç†ç³»ç»Ÿ         # å‘ä»¶äººåç§°  
  receiver_email: recipient@example.com  # æ”¶ä»¶äººé‚®ç®±
  use_ssl: false
  use_tls: true
```

### 3. å‡†å¤‡æ•°æ®

**åˆ›å»ºç¤ºä¾‹æ•°æ®æ–‡ä»¶ï¼š**
```bash
python -m licence_management --create-sample
```

è¿™ä¼šåœ¨ `sample_data/äººå‘˜è¯ä»¶ä¿¡æ¯.csv` åˆ›å»ºç¤ºä¾‹æ•°æ®ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š
- `person_name`: å§“å
- `document_type`: è¯ä»¶ç±»å‹  
- `start_date`: æœ‰æ•ˆæœŸå¼€å§‹æ—¥æœŸ
- `expiry_date`: æœ‰æ•ˆæœŸç»“æŸæ—¥æœŸ
- `remarks`: å¤‡æ³¨ä¿¡æ¯

## ğŸ¯ åŠŸèƒ½ä½¿ç”¨

### é‚®ä»¶æé†’ï¼ˆé»˜è®¤åŠŸèƒ½ï¼‰
```bash
# æ‰«æè¯ä»¶æ•°æ®ï¼Œå‘é€åˆ°æœŸæé†’é‚®ä»¶
python -m licence_management
```

### ç”ŸæˆçŠ¶æ€æŠ¥å‘Š
```bash
# ç”Ÿæˆæ‰€æœ‰è¯ä»¶çš„çŠ¶æ€æŠ¥å‘Š
python -m licence_management --report

# æŒ‡å®šè¾“å‡ºæ–‡ä»¶å
python -m licence_management --report --output æˆ‘çš„è¯ä»¶æŠ¥å‘Š.csv
```

### æµ‹è¯•é‚®ä»¶é…ç½®
```bash
# å‘é€æµ‹è¯•é‚®ä»¶ï¼ŒéªŒè¯é‚®ä»¶é…ç½®æ˜¯å¦æ­£ç¡®
python -m licence_management --test-email
```

### æŸ¥çœ‹å¸®åŠ©
```bash
python -m licence_management --help
```

## âš™ï¸ é…ç½®è¯¦è§£

### é‚®ä»¶é…ç½®
```yaml
email:
  smtp_server: smtp.qq.com      # SMTPæœåŠ¡å™¨åœ°å€
  smtp_port: 587               # SMTPç«¯å£å·
  smtp_user: your_email        # ç™»å½•ç”¨æˆ·å
  smtp_password: auth_code     # ç™»å½•å¯†ç /æˆæƒç 
  sender_name: ç³»ç»Ÿåç§°         # å‘ä»¶äººæ˜¾ç¤ºåç§°
  receiver_email: recv@xx.com  # æ”¶ä»¶äºº(æ”¯æŒå¤šä¸ªï¼Œé€—å·åˆ†éš”)
  use_ssl: false              # æ˜¯å¦ä½¿ç”¨SSL
  use_tls: true               # æ˜¯å¦ä½¿ç”¨TLS
```

### æé†’è§„åˆ™é…ç½®
```yaml
reminder:
  days_before_expiry: [60, 30, 7, 1]  # æé†’èŠ‚ç‚¹(åœ¨åˆ°æœŸå‰å¤šå°‘å¤©æé†’)
```

### æŠ¥å‘Šé…ç½®
```yaml
report:
  output_filename: è¯ä»¶çŠ¶æ€æŠ¥å‘Š_{date}.csv    # æŠ¥å‘Šæ–‡ä»¶åæ¨¡æ¿
  days_until_expiring_threshold: 30          # å³å°†è¿‡æœŸçš„å¤©æ•°é˜ˆå€¼
```

### æ•°æ®æ–‡ä»¶é…ç½®
```yaml
data_file: sample_data/äººå‘˜è¯ä»¶ä¿¡æ¯.csv      # CSVæ•°æ®æ–‡ä»¶è·¯å¾„
log_level: INFO                            # æ—¥å¿—çº§åˆ«
log_file: logs/licence_management_{date}.log  # æ—¥å¿—æ–‡ä»¶è·¯å¾„
```

## ğŸ“§ é‚®ä»¶æœåŠ¡å™¨é…ç½®ç¤ºä¾‹

### QQé‚®ç®±
```yaml
email:
  smtp_server: smtp.qq.com
  smtp_port: 587
  smtp_user: your_qq@qq.com
  smtp_password: your_auth_code  # QQé‚®ç®±æˆæƒç 
  use_ssl: false
  use_tls: true
```

### 163é‚®ç®±
```yaml
email:
  smtp_server: smtp.163.com  
  smtp_port: 25
  smtp_user: your_name@163.com
  smtp_password: your_auth_code
  use_ssl: false
  use_tls: false
```

### Gmail
```yaml
email:
  smtp_server: smtp.gmail.com
  smtp_port: 587
  smtp_user: your_name@gmail.com  
  smtp_password: your_app_password
  use_ssl: false
  use_tls: true
```

## ğŸ“Š CSVæ•°æ®æ ¼å¼

### å¿…éœ€å­—æ®µ
- `person_name`: äººå‘˜å§“å
- `document_type`: è¯ä»¶ç±»å‹ï¼ˆå¦‚ï¼šèº«ä»½è¯ã€æŠ¤ç…§ã€é©¾é©¶è¯ç­‰ï¼‰
- `expiry_date`: åˆ°æœŸæ—¥æœŸ

### å¯é€‰å­—æ®µ  
- `start_date`: å¼€å§‹æ—¥æœŸ
- `remarks`: å¤‡æ³¨ä¿¡æ¯

### æ—¥æœŸæ ¼å¼æ”¯æŒ
- `20240101` (æ¨èæ ¼å¼)
- `2024-01-01`
- `2024/01/01`
- `01/01/2024`
- `2024å¹´01æœˆ01æ—¥`

### CSVç¤ºä¾‹
```csv
person_name,document_type,start_date,expiry_date,remarks
å¼ ä¸‰,èº«ä»½è¯,2014-09-16,2025-09-16,ç ”å‘éƒ¨
æå››,æŠ¤ç…§,2020-03-15,2025-10-16,å¸‚åœºéƒ¨  
ç‹äº”,é©¾é©¶è¯,2018-09-16,2025-09-23,è¡Œæ”¿éƒ¨
```

## ğŸ—“ï¸ å®šæ—¶ä»»åŠ¡è®¾ç½®

### Windowsç³»ç»Ÿï¼ˆä»»åŠ¡è®¡åˆ’ç¨‹åºï¼‰

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨è„šæœ¬ä¸€é”®åˆ›å»ºï¼ˆæ¨èï¼‰
- å³é”®ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼š`scripts\setup_task.bat`
- æˆ–åœ¨â€œç®¡ç†å‘˜ PowerShellâ€è¿è¡Œï¼š
```powershell
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
.\scripts\setup_windows_task.ps1 -ProjectPath "D:\Code\Licence_Management"
.\scripts\setup_windows_task.ps1 -OnlyCatchup
```
ä¸Šè¿°å‘½ä»¤ä¼šåˆ›å»ºä¸¤ä¸ªè®¡åˆ’ä»»åŠ¡ï¼š
- æ¯å¤© 21:00 æ­£å¸¸æ‰§è¡Œï¼š`python scripts/scheduled_runner.py run`
- æ¯å¤© 10:30 è¡¥å¿æ‰§è¡Œï¼š`python scripts/scheduled_runner.py catchup`

#### æ–¹æ³•äºŒï¼šä»»åŠ¡è®¡åˆ’ç¨‹åºä¸­æ‰‹åŠ¨åˆ›å»º
1. æ‰“å¼€"ä»»åŠ¡è®¡åˆ’ç¨‹åº"
2. åˆ›å»ºåŸºæœ¬ä»»åŠ¡ï¼ˆå¦‚ï¼šè¯ä»¶ç®¡ç†ç³»ç»Ÿ-æ¯æ—¥æé†’ï¼‰
3. è®¾ç½®è§¦å‘å™¨ï¼ˆæ¯å¤© 21:00ï¼‰
4. è®¾ç½®æ“ä½œï¼š
   - ç¨‹åºï¼š`python`
   - å‚æ•°ï¼š`scripts/scheduled_runner.py run`
   - èµ·å§‹ç›®å½•ï¼šé¡¹ç›®æ ¹ç›®å½•
5. å†åˆ›å»ºä¸€ä¸ªâ€œè¡¥å¿æ‰§è¡Œâ€ä»»åŠ¡ï¼ˆæ¯å¤© 10:30ï¼‰ï¼š
   - ç¨‹åºï¼š`python`
   - å‚æ•°ï¼š`scripts/scheduled_runner.py catchup`
   - èµ·å§‹ç›®å½•ï¼šé¡¹ç›®æ ¹ç›®å½•

#### è¡¥å¿æ‰§è¡Œä¸æ—¥å¿—
- æˆåŠŸæ—¶é—´è®°å½•ï¼š`logs/last_success_iso.txt`
- è°ƒåº¦è¿è¡Œæ—¥å¿—ï¼š`logs/scheduled_runner.log`ï¼ˆè¶…è¿‡ 1MB è‡ªåŠ¨è½®è½¬ï¼‰
- ä¸šåŠ¡æ—¥å¿—ï¼š`logs/licence_management_{date}.log`

#### ä»»åŠ¡ç®¡ç†ï¼ˆPowerShellï¼‰
```powershell
# æ‰‹åŠ¨è¿è¡Œä»»åŠ¡
Get-ScheduledTask -TaskName "è¯ä»¶ç®¡ç†ç³»ç»Ÿ-æ¯æ—¥æé†’" | Start-ScheduledTask

# åˆ é™¤ä»»åŠ¡
Unregister-ScheduledTask -TaskName "è¯ä»¶ç®¡ç†ç³»ç»Ÿ-æ¯æ—¥æé†’" -Confirm:$false
Unregister-ScheduledTask -TaskName "è¯ä»¶ç®¡ç†ç³»ç»Ÿ-è¡¥å¿æ‰§è¡Œ" -Confirm:$false
```

#### ç«‹å³è§¦å‘ä¸€æ¬¡æ£€æŸ¥
```bash
python scripts/scheduled_runner.py run
```

### Linux/macOSç³»ç»Ÿï¼ˆcrontabï¼‰

### Linux/macOSç³»ç»Ÿï¼ˆcrontabï¼‰
```bash
# ç¼–è¾‘å®šæ—¶ä»»åŠ¡
crontab -e

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯æ—¥æ—©ä¸Š9ç‚¹æ‰§è¡Œï¼‰
0 9 * * * cd /path/to/project && python -m licence_management
```

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**1. é‚®ä»¶å‘é€å¤±è´¥**
- æ£€æŸ¥SMTPæœåŠ¡å™¨åœ°å€å’Œç«¯å£
- ç¡®è®¤é‚®ç®±ç”¨æˆ·åå’Œæˆæƒç æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- å°è¯•ä½¿ç”¨æµ‹è¯•é‚®ä»¶åŠŸèƒ½ï¼š`python -m licence_management --test-email`

**2. CSVæ–‡ä»¶è¯»å–é”™è¯¯**
- ç¡®è®¤æ–‡ä»¶ç¼–ç ä¸ºUTF-8
- æ£€æŸ¥å¿…éœ€å­—æ®µæ˜¯å¦å­˜åœ¨
- éªŒè¯æ—¥æœŸæ ¼å¼æ˜¯å¦æ­£ç¡®

**3. é…ç½®æ–‡ä»¶é”™è¯¯**
- ä½¿ç”¨`--init-config`é‡æ–°ç”Ÿæˆé…ç½®æ¨¡æ¿
- æ£€æŸ¥YAMLæ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆæ³¨æ„ç¼©è¿›ï¼‰
- ç¡®è®¤å¿…éœ€é…ç½®é¡¹æ˜¯å¦å¡«å†™

**4. ä¾èµ–åº“é—®é¢˜**
```bash
# é‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt --upgrade
```

### è°ƒè¯•æ¨¡å¼
```bash
# æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—ä¿¡æ¯
python -m licence_management --verbose
```

### æŸ¥çœ‹æ—¥å¿—
æ—¥å¿—æ–‡ä»¶ä½ç½®ï¼š`logs/licence_management_YYYYMMDD.log`

## ğŸ“ é¡¹ç›®ç»“æ„

```
Licence_Management/
â”œâ”€â”€ licence_management/           # ä¸»ç¨‹åºåŒ…
â”‚   â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–
â”‚   â”œâ”€â”€ __main__.py              # ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ main.py                  # ä¸»ç¨‹åºé€»è¾‘
â”‚   â”œâ”€â”€ config/                  # é…ç½®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ data/                    # æ•°æ®å¤„ç†æ¨¡å—  
â”‚   â”œâ”€â”€ business/                # ä¸šåŠ¡é€»è¾‘æ¨¡å—
â”‚   â”œâ”€â”€ email/                   # é‚®ä»¶å‘é€æ¨¡å—
â”‚   â”œâ”€â”€ utils/                   # å·¥å…·æ¨¡å—
â”‚   â””â”€â”€ templates/               # é‚®ä»¶æ¨¡æ¿
â”œâ”€â”€ sample_data/                 # ç¤ºä¾‹æ•°æ®ç›®å½•
â”œâ”€â”€ config_templates/            # é…ç½®æ¨¡æ¿ç›®å½•
â”œâ”€â”€ logs/                        # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ config.yaml                  # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt             # ä¾èµ–æ–‡ä»¶
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ REQUIREMENTS.md              # éœ€æ±‚æ–‡æ¡£
â””â”€â”€ ä½¿ç”¨è¯´æ˜.md                  # ä½¿ç”¨è¯´æ˜
```

## ğŸ›¡ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹

1. **é‚®ç®±æˆæƒç å®‰å…¨**ï¼šä¸è¦å°†åŒ…å«çœŸå®é‚®ç®±å¯†ç çš„é…ç½®æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
2. **æ–‡ä»¶æƒé™**ï¼šé€‚å½“è®¾ç½®é…ç½®æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶çš„è®¿é—®æƒé™
3. **ç½‘ç»œå®‰å…¨**ï¼šåœ¨ä¼ä¸šç¯å¢ƒä¸­ä½¿ç”¨æ—¶ï¼Œç¡®è®¤SMTPæœåŠ¡ç¬¦åˆå®‰å…¨ç­–ç•¥

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

å¦‚éœ€æŠ€æœ¯æ”¯æŒæˆ–æŠ¥å‘Šé—®é¢˜ï¼Œè¯·ï¼š
1. æ£€æŸ¥æœ¬ä½¿ç”¨è¯´æ˜å’Œæ•…éšœæ’æŸ¥éƒ¨åˆ†
2. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶äº†è§£è¯¦ç»†é”™è¯¯ä¿¡æ¯
3. ç¡®è®¤é…ç½®æ–‡ä»¶æ ¼å¼å’Œå†…å®¹æ­£ç¡®æ€§

---

**ç‰ˆæœ¬ï¼š** 1.0.0  
**æ›´æ–°æ—¥æœŸï¼š** 2025-09-16 